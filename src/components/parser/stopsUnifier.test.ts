import { expect, test } from "vitest";

import { mergeAndGroup } from "./stopsUnifier.js";

test.each([
  {
    title: "test ",
    input: [
      [1, 2, 3, 4, 5, 6, 7, 8],
      [-1, -2, -3, 1, 2, 3, 77, 76, 75],
      [9, 10, 1, 2, 3, 11, 12],
      [1, 2, 3],
    ],
    output: [
      [
        [-1, -2, -3],
        [9, 10],
      ],
      1,
      2,
      3,
      [
        [4, 5, 6, 7, 8],
        [77, 76, 75],
        [11, 12],
      ],
    ],
  },
  {
    title: "25 North",
    input: [
      [
        14147, 3807, 6904, 1163, 7723, 279, 9720, 10195, 8954, 5504, 5214, 5186,
        3405, 5065, 278, 6399, 8040, 638,
      ],
      [
        14159, 6070, 9364, 2329, 5662, 5486, 24186, 7240, 8446, 613, 1197, 609,
        2900, 5132, 4580, 611, 937, 1049, 4777, 5763, 24108, 271, 280, 8401,
        8421, 4950, 4096, 1305, 3286, 5740, 2702, 6749, 8147, 4282, 3388, 9911,
        10280, 4017, 24367, 9779, 14147, 3807, 6904, 1163, 7723, 279, 9720,
        10195, 8954, 5504, 5214, 5186, 3405, 5065, 278, 6399, 8040, 638,
      ],
      [
        14828, 9010, 2882, 7079, 2386, 10280, 4017, 24367, 9779, 14147, 3807,
        6904, 1163, 7723, 279, 9720, 10195, 8954, 5504, 5214, 5186, 3405, 5065,
        278, 6399, 8040, 638,
      ],
    ],
    output: [
      [
        [
          14159, 6070, 9364, 2329, 5662, 5486, 24186, 7240, 8446, 613, 1197,
          609, 2900, 5132, 4580, 611, 937, 1049, 4777, 5763, 24108, 271, 280,
          8401, 8421, 4950, 4096, 1305, 3286, 5740, 2702, 6749, 8147, 4282,
          3388, 9911,
        ],
        [14828, 9010, 2882, 7079, 2386],
      ],
      10280,
      4017,
      24367,
      9779,
      14147,
      3807,
      6904,
      1163,
      7723,
      279,
      9720,
      10195,
      8954,
      5504,
      5214,
      5186,
      3405,
      5065,
      278,
      6399,
      8040,
      638,
    ],
  },
  {
    title: "25 South",
    input: [
      [
        638, 5457, 2404, 3889, 4184, 3207, 1743, 8230, 24785, 1329, 6878, 3480,
        14147,
      ],
      [
        638, 5457, 2404, 3889, 4184, 3207, 1743, 8230, 24785, 1329, 6878, 3480,
        14145, 4596, 24368, 1007, 7944, 5798, 1586, 4590, 9682, 4909, 10178,
        9478, 3736, 7579, 1984, 4938, 2768, 2974, 15370, 6896, 270, 6261, 9804,
        3115, 7561, 8512, 8816, 1009, 4727, 3938, 4574, 9979, 4058, 3105, 6112,
        5583, 10380, 7151, 5650, 6540, 5251, 14159,
      ],
      [
        638, 5457, 2404, 3889, 4184, 3207, 1743, 8230, 24785, 1329, 6878, 3480,
        274, 4596, 24368, 1007, 7944, 5798, 1586, 4590, 9682, 4909, 10178, 9478,
        3736, 7579, 1984, 4938, 2768, 2974, 15370, 6896, 270, 6261, 9804, 3115,
        7561, 8512, 8816, 1009, 4727, 3938, 4574, 9979, 4058, 3105, 6112, 5583,
        10380, 7151, 5650, 6540, 5251, 14159,
      ],
    ],
    output: [
      638,
      5457,
      2404,
      3889,
      4184,
      3207,
      1743,
      8230,
      24785,
      1329,
      6878,
      3480,
      [[14147], [14145], [274]],
      4596,
      24368,
      1007,
      7944,
      5798,
      1586,
      4590,
      9682,
      4909,
      10178,
      9478,
      3736,
      7579,
      1984,
      4938,
      2768,
      2974,
      15370,
      6896,
      270,
      6261,
      9804,
      3115,
      7561,
      8512,
      8816,
      1009,
      4727,
      3938,
      4574,
      9979,
      4058,
      3105,
      6112,
      5583,
      10380,
      7151,
      5650,
      6540,
      5251,
      14159,
    ],
  },
  {
    title: "939 East",
    input: [
      [
        14210, 5464, 9220, 9175, 7082, 3598, 4329, 5950, 4149, 3236, 5893, 5913,
        1612, 2054, 1436, 6515, 9154, 3974, 4669, 24631, 9256, 14015, 10483,
        12860, 12876, 4952, 10161, 791, 14088, 581,
      ],
      [
        23863, 623, 7976, 24443, 14209, 5464, 9220, 9175, 7082, 3598, 4329,
        5950, 4149, 3236, 5893, 5913, 1612, 1082, 14285, 7848, 24678, 24679,
        24709, 24682,
      ],
    ],
    output: [
      [[14210], [23863, 623, 7976, 24443, 14209]],
      5464,
      9220,
      9175,
      7082,
      3598,
      4329,
      5950,
      4149,
      3236,
      5893,
      5913,
      1612,
      [
        [
          2054, 1436, 6515, 9154, 3974, 4669, 24631, 9256, 14015, 10483, 12860,
          12876, 4952, 10161, 791, 14088, 581,
        ],
        [1082, 14285, 7848, 24678, 24679, 24709, 24682],
      ],
    ],
  },
])("unify $title", ({ input, output }) => {
  expect(mergeAndGroup(...input)).toEqual(output);
});

test("39 West", () => {
  expect(
    mergeAndGroup(
      [
        7900, 4347, 3848, 3452, 5134, 573, 3931, 9293, 1194, 4878, 1792, 2791,
        2575, 4303, 5724, 3447, 9219, 6792, 9152, 1273, 5205, 8031, 5901, 3980,
        6906, 8355, 9614, 3222, 2677, 6365, 7742, 8388, 14208,
      ],
      [
        3900, 1721, 12897, 12896, 12925, 12874, 10484, 14063, 363, 24630, 8611,
        2325, 5604, 8784, 5441, 7057, 3863, 2603, 2556, 6326, 6179, 5709, 8531,
        6644, 8503, 5345, 9113, 1548, 3127, 7784, 2822, 5537, 8963, 3071, 1092,
        9968, 1792, 2791, 2575, 4303, 5724, 3447, 9219, 6792, 9152, 1273, 5205,
        8031, 5901, 3980, 6906, 8355, 9614, 3222, 2677, 6365, 7742, 8388, 14208,
      ],
      [
        8422, 5879, 935, 6723, 24630, 8611, 2325, 5604, 8784, 5441, 7057, 3863,
        2603, 2556, 6326, 6179, 5709, 8531, 6644, 8503, 5345, 9113, 1548, 3127,
        7784, 2822, 5537, 8963, 3071, 1092, 9968, 1792, 2791, 2575, 4303, 5724,
        3447, 9219, 6792, 9152, 1273, 5205, 8031, 5901, 3980, 6906, 8355, 9614,
        3222, 2677, 6365, 7742, 8388, 14208,
      ]
    )
  ).toEqual([
    [
      [7900, 4347, 3848, 3452, 5134, 573, 3931, 9293, 1194, 4878],
      [
        [3900, 1721, 12897, 12896, 12925, 12874, 10484, 14063, 363],
        [8422, 5879, 935, 6723],
        24630,
        8611,
        2325,
        5604,
        8784,
        5441,
        7057,
        3863,
        2603,
        2556,
        6326,
        6179,
        5709,
        8531,
        6644,
        8503,
        5345,
        9113,
        1548,
        3127,
        7784,
        2822,
        5537,
        8963,
        3071,
        1092,
        9968,
      ],
    ],
    1792,
    2791,
    2575,
    4303,
    5724,
    3447,
    9219,
    6792,
    9152,
    1273,
    5205,
    8031,
    5901,
    3980,
    6906,
    8355,
    9614,
    3222,
    2677,
    6365,
    7742,
    8388,
    14208,
  ]);
});
test("39 East", () => {
  expect(
    mergeAndGroup(
      [
        14208, 5410, 4707, 6717, 2290, 8607, 2572, 6763, 5464, 7669, 3454, 5923,
        8541, 1641, 3561, 9220, 5212, 8806, 2980, 9985, 7082, 2766, 3332, 6627,
        6641, 8809, 4319, 7127, 6436, 4091, 7900,
      ],
      [
        14208, 5410, 4707, 6717, 2290, 8607, 2572, 6763, 5464, 7669, 3454, 5923,
        8541, 1641, 3561, 9220, 5212, 8806, 2980, 9985, 7082, 2766, 3598, 4329,
        7027, 10189, 5950, 2397, 4355, 4149, 8689, 3528, 3236, 1934, 8546, 5893,
        2537, 5913, 3313, 1612, 2054, 1436, 6515, 9154, 3974, 4669, 24631, 9256,
        14015, 10483, 12860, 14016, 14017, 14018, 6681, 1146, 5085, 3900,
      ],
      [24631, 9256, 596, 8422]
    )
  ).toEqual([
    14208,
    5410,
    4707,
    6717,
    2290,
    8607,
    2572,
    6763,
    5464,
    7669,
    3454,
    5923,
    8541,
    1641,
    3561,
    9220,
    5212,
    8806,
    2980,
    9985,
    7082,
    2766,
    [
      [3332, 6627, 6641, 8809, 4319, 7127, 6436, 4091, 7900],
      [
        3598,
        4329,
        7027,
        10189,
        5950,
        2397,
        4355,
        4149,
        8689,
        3528,
        3236,
        1934,
        8546,
        5893,
        2537,
        5913,
        3313,
        1612,
        2054,
        1436,
        6515,
        9154,
        3974,
        4669,
        24631,
        9256,
        [
          [14015, 10483, 12860, 14016, 14017, 14018, 6681, 1146, 5085, 3900],
          [596, 8422],
        ],
      ],
    ],
  ]);
});
